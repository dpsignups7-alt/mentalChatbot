<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sign Up</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #6a11cb, #2575fc);
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card {
  background: rgba(255, 255, 255, 0.88);
  backdrop-filter: blur(10px);
  padding: 32px;
  border-radius: 20px;
  width: 360px;
  box-shadow: 0 8px 35px rgba(0, 0, 0, 0.22);
  animation: fadeIn 0.6s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

h2 {
  text-align: center;
  margin-bottom: 20px;
  color: #333;
}

.input-box {
  margin-bottom: 14px;
  position: relative;
}

input {
  width: 100%;
  padding: 12px 42px 12px 14px;
  border-radius: 12px;
  border: 1px solid #ccc;
  outline: none;
  font-size: 15px;
  box-sizing: border-box;
}

input:focus {
  border-color: #6a11cb;
  box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.22);
}

button {
  width: 100%;
  padding: 12px;
  border-radius: 12px;
  border: none;
  background: #2575fc;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  font-size: 16px;
  transition: 0.25s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

button:hover {
  background: #1a5edb;
}

button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}

.error {
  color: #b00020;
  text-align: center;
  margin-bottom: 10px;
  font-size: 14px;
}

.muted {
  text-align: center;
  margin-top: 12px;
  font-size: 14px;
}

/* Eye Icon */
.eye {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  font-size: 18px;
  color: #666;
}

/* Spinner */
.spinner {
  width: 18px;
  height: 18px;
  border: 3px solid #fff;
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
  display: none;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>

<body>

<div class="card">
  <h2>Create an account</h2>

  <div id="error" class="error" style="display:none"></div>

  <div class="input-box">
    <input id="name" placeholder="Full name">
  </div>

  <div class="input-box">
    <input id="email" placeholder="Email">
  </div>

  <div class="input-box">
    <input id="password" type="password" placeholder="Password">
    <span class="eye" id="togglePassword">üëÅÔ∏è</span>
  </div>

  <button id="signupBtn">
    Sign Up
    <div class="spinner" id="spinner"></div>
  </button>

  <p class="muted">Already have an account? <a href="/frontend/login.html">Login</a></p>
</div>

<script>
// Password toggle
const togglePassword = document.getElementById("togglePassword");
const passwordField = document.getElementById("password");

togglePassword.addEventListener("click", () => {
  const type = passwordField.type === "password" ? "text" : "password";
  passwordField.type = type;
  togglePassword.textContent = type === "password" ? "üëÅÔ∏è" : "üôà";
});

// Signup Validation + Spinner
const signupBtn = document.getElementById("signupBtn");
const spinner = document.getElementById("spinner");

signupBtn.addEventListener("click", async () => {
  const name = document.getElementById("name").value.trim();
  const email = document.getElementById("email").value.trim();
  const password = passwordField.value;
  const errorEl = document.getElementById("error");

  errorEl.style.display = "none";

  if (!name || !email || !password) {
    errorEl.innerText = "All fields are required";
    errorEl.style.display = "block";
    return;
  }

  spinner.style.display = "block";
  signupBtn.disabled = true;

  try {
    const res = await fetch("/api/signup", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, email, password })
    });

    const data = await res.json();
    if (!res.ok) throw new Error(data.message || "Signup failed");

    window.location.href = "/profile.html";
  } catch (err) {
    errorEl.innerText = err.message;
    errorEl.style.display = "block";
  } finally {
    spinner.style.display = "none";
    signupBtn.disabled = false;
  }
});
</script>

</body>
</html>
